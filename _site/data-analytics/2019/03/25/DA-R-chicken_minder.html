<!DOCTYPE html>
<html lang="ko">

  <head lang="ko">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>[R] 치킨 대격변 5년 - 서울시 1인 가구 비율에 따른 치킨 데이터 분석</title>
  <meta name="description" content="">
  
  <meta name="author" content="Roseline Song">
  <meta name="copyright" content="&copy; Roseline Song 2019">
  

  <!-- External libraries -->
  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/atom-one-dark.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="" />
  <meta property="og:url" content="http://roseline124.github.io" />
  <meta property="og:site_name" content="유혹하는 개발하기" />
  <meta property="og:title" content="[R] 치킨 대격변 5년 - 서울시 1인 가구 비율에 따른 치킨 데이터 분석" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://roseline124.github.io/assets/images/chicken.jpg" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="[R] 치킨 대격변 5년 - 서울시 1인 가구 비율에 따른 치킨 데이터 분석">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="http://roseline124.github.io/assets/images/chicken.jpg">
  <meta name="twitter:url" content="http://roseline124.github.io">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/spacing.css">
  <link rel="canonical" href="http://roseline124.github.io/data-analytics/2019/03/25/DA-R-chicken_minder.html">
  <link rel="alternate" type="application/rss+xml" title="유혹하는 개발하기" href="http://roseline124.github.io/feed.xml" />
</head>


  <body>

    <header class="navbar nav-bg navigation nav-top " role="banner">
  <div class="navigation-wrapper">
    <!-- <a href="/" class="logo">
      
      <span>유혹하는 개발하기</span>
      
    </a> -->
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        <li class="nav-link"><a href="/">Home</a>
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
          <li class="nav-link"><a href="/category/">Category</a>
          
        
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/tag/">Tag</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/images/chicken.jpg);">
  <div class="scrim has-cover">
    <header class="post-header" style="padding-left:8rem;">
        
           
            <p class="category">Data-analytics</p>
          
        
        <!-- display:inline-block : 콘텐츠 길이에 맞춰 너비 조정 -->
      <div style="display:inline-block;">
        <p class="title">[R] 치킨 대격변 5년 - 서울시 1인 가구 비율에 따른 치킨 데이터 분석</p>
        
        <hr>

        <p class="info">by Roseline Song | March 25, 2019</p>
      </div>
    </header>
    <a href="#content-post" class="scroll-down icon-arrow-left" data-offset="-45">
        <span class="hidden">Scroll Down</span>
      </a>
  </div>
</div>

<div class="wrapper">



<section class="post-meta" id="content-post">
  <div class="post-date">March 25, 2019</div>
  <div class="post-categories">
  in 
    
    <a href="/category/Data-Analytics">Data-analytics</a>
    
  
  </div>
</section>

<article class="post-content">
  <p><br /></p>

<h3 id="section">치킨 대격변 5년 : 서울시 1인 가구 비율에 따른 치킨 데이터 분석</h3>

<p>1인 가구 비율과 치킨 통화 건수 비율의 상관관계를 밝힌다. 결과가 아주 흥미롭다. 그래프를 보는 순간 ‘응???’이라는 반응이 나올 것이다.</p>

<p>※ 데이터는 <strong>SK 데이터 허브의 월별 서울시 치킨 통화 건수</strong>와 공공데이터포털의 <strong>서울시 분기별 세대당 인구수 데이터 파일</strong>을 병합 및 재가공했다.</p>

<p><br />
<br /></p>

<h3 id="section-1">결과 : 갭마인더 그래프 확인하기</h3>

<p><br /></p>

<p>&gt; <a href="https://roseline124.github.io/assets/files/chicken_minder.html">Chicken Minder 그래프 결과 확인하기</a></p>

<p><br /></p>

<p><img src="/assets/images/190326_chicken_minder.PNG" /></p>

<p><br />
<br /></p>

<h3 id="section-2">인사이트 1 : “배달앱 사용의 증가”</h3>

<p><br /></p>

<h4 id="section-3">20대, 1인 가구 공략 : “통화보다는 배달앱이 더 편한 밀레니엄 세대”</h4>
<p><br /></p>

<p>2014년에서 2015년도까지는 통화건수가 세대당 인구 수에 비례하는 관계를 보였다. 하지만, 2016년부터는 1인 가구 비율이 늘어나면서 데이터 포인트가 전체적으로 왼쪽으로 이동하고, 통화 건수도 줄어드는 양상을 보인다. 데이터가 이상하다. 1인 가구가 치킨을 적게 시켜먹는다니?</p>

<p>1인 가구 비율이 높을 수록 치킨을 더 적게 시켜먹는 걸까? 그렇지 않다. <a href="http://blog.cheil.com/magazine/33722">인터넷에 떠돌아다니는 자료</a>만 봐도 1인 가구, 20대 젊은 세대들이 가장 치킨을 많이 시켜먹는다.</p>

<p>그렇다면 왜 저런 결과가 나타난 것일까? <code class="highlighter-rouge">'통화건수' = 치킨 배달수</code>라고 보면 안된다. 이는 완전히 배달 건수를 반영한 게 아니다. <strong>배달앱</strong>이 있기 때문이다.</p>

<p>갭마인더 그래프를 실행시키면 <strong>배달의 민족이 출시된 2015년부터 통화건수가 전체적으로 낮아지기 시작</strong>한다. 치킨 배달 건수가 줄어든 게 아니다. <strong>‘통화’가 줄고 ‘앱’으로 시키는 배달이 증가</strong>한 것이다.</p>

<p>따라서, 20대, 1인 가구를 공략하고 싶다면 아직 배달앱을 지원하고 있지 않은 치킨 매장은 배달앱 활용을 시작해야한다.</p>

<p><br />
<br /></p>

<h3 id="section-4">인사이트 2 : “치킨은 관악구에서 튀기자”</h3>

<p><br /></p>

<h4 id="section-5">관악구는 치킨 수요가 많다.</h4>

<p>13년부터 17년까지 관악구의 1인 가구 비율은 줄곧 높았다. 하지만 특이한 것은 1인 가구 비율이 높은 데도 <strong>통화 건수</strong>가 높다는 것이었다. 관악구는 배달앱을 쓰지 않는 사람들만 모인 걸까??? 혹은 관악구의 치킨 매장들이 배달앱을 지원하지 않는 걸까??? 둘 다 아니다.</p>

<p>관악구는 앱을 통한 주문과는 별개로 그냥 <strong>주문 건 수 자체가 월등히 많기 때문</strong>이다. 관악구는 <strong>서울대, 신림동 고시촌, 신혼부부와 같이 젊은 세대들이 밀집</strong>해 있는 지역이다. 앱이든 전화든 치킨 배달 건 수가 많을 것이다.</p>

<p><br /></p>

<h5 id="section-6">데이터에서 드러난 신림동 고시촌의 격변</h5>

<p><br /></p>

<p><img src="/assets/images/quan-ak.png" /></p>

<p><br /></p>

<p>2017년 즈음 사시 폐지로 신림동 고시촌이 위기를 겪은 적이 있었다. 갭마인더 그래프에서 관악구 점을 더블 클릭해서 다시 플레이해보자. 다른 지역에 비해 여전히 높긴 하지만 지난 5년에 비해 가장 낮은 수치다. 왜? 청년들이 없기 때문에. 사시가 폐지되어 상권이 망해갔기 때문이다. 다행히 지금은 신림동의 화려한 부활이라는 기사가 뜰 정도로 다시 살아났다.</p>

<p><br /></p>

<p>&gt; <a href="http://realty.chosun.com/site/data/html_dir/2019/02/01/2019020102150.html">신림동 고시촌 이야기</a></p>

<p><br />
<br />
<br /></p>

<h3 id="r-">R 코드</h3>

<p><strong>clean_chicken_data.r</strong></p>

<p>오직 chicken.xlsx를 위한 함수다. 분기별로 데이터를 보여주고 싶었기에 월별 데이터를 모두 가공해야했다. 그러나 시간도 없고, 일일이 엑셀을 손볼 수는 없었다. 다행히 SK에서는 5년 동안 비슷한 양식으로 업로드 해왔기 때문에, 함수를 만들어 이 문제를 해결할 수 있었다.</p>

<p><br /></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">clean_chicken_data</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">year</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span>
  
  <span class="n">dir_path</span> <span class="o">&lt;-</span> <span class="n">paste</span><span class="p">(</span><span class="s">"dataset/chicken_"</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
  <span class="n">files</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="o">.</span><span class="n">files</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>
  
  <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
  
  <span class="k">for</span> <span class="p">(</span><span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"####### DATA LOAD ... ########"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    
    <span class="c">######## 데이터 로드 ########</span>
    <span class="n">file_path</span> <span class="o">&lt;-</span> <span class="n">paste</span><span class="p">(</span><span class="n">dir_path</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">"/"</span><span class="p">)</span>
    <span class="n">raw_df</span> <span class="o">&lt;-</span> <span class="n">read_excel</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c">######## 데이터 가공 ########</span>
    <span class="c"># for문 밖에서 해도 되지만 메모리를 효율적으로 쓰기 위해.</span>
    <span class="c"># 인덱싱 </span>
    <span class="k">if</span><span class="p">(</span><span class="n">year</span><span class="o">==</span><span class="mi">2017</span><span class="p">){</span>
      <span class="n">idx</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">idx</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">tmp</span> <span class="o">&lt;-</span> <span class="n">raw_df</span><span class="p">[,</span> <span class="n">idx</span><span class="p">]</span>
    <span class="n">colnames</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="s">"기준일"</span><span class="p">,</span> <span class="s">"요일"</span><span class="p">,</span> <span class="s">"성별"</span><span class="p">,</span> <span class="s">"연령대"</span><span class="p">,</span> <span class="s">"시군구"</span><span class="p">,</span> <span class="s">"통화건수"</span><span class="p">)</span>
    
    <span class="c"># lapply : 여러 컬럼 한꺼번에 데이터타입 바꾸는 법</span>
    <span class="n">cols</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="s">"성별"</span><span class="p">,</span> <span class="s">"연령대"</span><span class="p">,</span> <span class="s">"시군구"</span><span class="p">)</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">lapply</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="n">cols</span><span class="p">],</span> <span class="n">factor</span><span class="p">)</span>
    
    <span class="n">tmp</span><span class="err">$통화건수</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="n">tmp</span><span class="err">$통화건수</span><span class="p">)</span>
    
    <span class="c"># 데이터 병합</span>
    <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">rbind</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
  <span class="p">}</span> <span class="c"># for 문 </span>
  
  
  <span class="c">############### 분기별 정리 #################</span>
  <span class="n">date</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">ch</span><span class="err">$기준일</span><span class="p">),</span> <span class="n">format</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">Y</span><span class="si">%</span><span class="s">m</span><span class="si">%</span><span class="s">d"</span><span class="p">)</span>
  <span class="n">lt</span> <span class="o">&lt;-</span> <span class="n">unclass</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">POSIXlt</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>
  <span class="n">date_vector</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="s">"날짜"</span><span class="p">,</span> <span class="s">"연"</span><span class="p">,</span> <span class="s">"월"</span><span class="p">,</span> <span class="s">"일"</span><span class="p">)</span>
  <span class="n">ch</span><span class="p">[,</span> <span class="n">date_vector</span> <span class="p">]</span> <span class="o">&lt;-</span> <span class="k">with</span><span class="p">(</span><span class="n">lt</span><span class="p">,</span> 
                             <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="err">날짜</span> <span class="o">=</span> <span class="n">date</span>
                                          <span class="p">,</span> <span class="err">연</span> <span class="o">=</span> <span class="n">year</span> <span class="o">+</span> <span class="mi">1900</span>
                                          <span class="p">,</span> <span class="err">월</span> <span class="o">=</span> <span class="n">mon</span> <span class="o">+</span> <span class="mi">1</span>
                                          <span class="p">,</span> <span class="err">일</span> <span class="o">=</span> <span class="n">mday</span><span class="p">))</span>
  
  <span class="c"># 인덱싱 </span>
  <span class="n">ch</span> <span class="o">&lt;-</span> <span class="n">cbind</span><span class="p">(</span><span class="n">ch</span><span class="p">[,</span><span class="mi">8</span><span class="p">:</span><span class="mi">9</span><span class="p">],</span> <span class="n">ch</span><span class="p">[,</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
  
  <span class="c"># Quater</span>
  <span class="n">ch</span><span class="err">$분기별</span> <span class="o">&lt;-</span> <span class="n">cut</span><span class="p">(</span><span class="n">ch</span><span class="err">$월</span><span class="p">,</span> 
                <span class="n">br</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span>
                <span class="n">labels</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="s">"1Q"</span><span class="p">,</span><span class="s">"2Q"</span><span class="p">,</span><span class="s">"3Q"</span><span class="p">,</span><span class="s">"4Q"</span><span class="p">))</span>
  
  <span class="k">return</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
  
<span class="p">}</span> </code></pre></figure>

<p><br />
<br /></p>

<h3 id="gapminder">서울시 치킨 Gapminder</h3>

<p><br /></p>

<p>Gapminder는 故 한스 로슬링 교수님이 만드신 통계 분석 서비스이다. 우리에게 익숙한 정적인 그래프에서 벗어나, 인터랙티브 그래프를 만들 수 있다. 데이터 포인트 위에 마우스를 올려놓으면 데이터의 정보가 뜨기도 하고, 연도에 따라 데이터 포인트가 움직이기도 한다.</p>

<p><br /></p>

<p><strong>chicken_minder.r</strong></p>

<p>서울시 구별 세대당 인구 수에 따른 통화 건수 변화를 갭마인더로 표현한다. 세대당 인구 수가 낮을 수록 1인 가구의 비율이 높다.</p>

<p><br /></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">COUNT</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="n">library</span><span class="p">(</span><span class="n">gapminder</span><span class="p">)</span>
<span class="n">source</span><span class="p">(</span><span class="s">"clean_chicken_data.R"</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf-8'</span><span class="p">)</span>

<span class="c">############# Chicken Data ##############</span>
<span class="n">years</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">)</span>

<span class="c"># Rbind all chicken files</span>
<span class="n">chs</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
  
<span class="k">for</span><span class="p">(</span><span class="n">y</span> <span class="ow">in</span> <span class="n">years</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">tmp</span> <span class="o">&lt;-</span> <span class="n">clean_chicken_data</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">chs</span> <span class="o">&lt;-</span> <span class="n">rbind</span><span class="p">(</span><span class="n">chs</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">head</span><span class="p">(</span><span class="n">chs</span><span class="p">)</span>
<span class="n">tail</span><span class="p">(</span><span class="n">chs</span><span class="p">)</span>

<span class="c"># 연도별, 분기별, 시군구, 통화건수 </span>
<span class="n">ch_by_quater</span> <span class="o">&lt;-</span> <span class="n">chs</span> <span class="o">%&gt;%</span> 
  <span class="n">group_by</span><span class="p">(</span><span class="err">연</span><span class="p">,</span> <span class="err">분기별</span><span class="p">,</span> <span class="err">시군구</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="n">summarise</span><span class="p">(</span><span class="err">통화건수</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="err">통화건수</span><span class="p">))</span>

<span class="n">View</span><span class="p">(</span><span class="n">ch_by_quater</span><span class="p">)</span>

<span class="n">head</span><span class="p">(</span><span class="n">ch_by_quater</span><span class="p">)</span>
<span class="n">tail</span><span class="p">(</span><span class="n">ch_by_quater</span><span class="p">)</span>

<span class="c">############# Seoul Population Data ##############</span>
<span class="n">seoul_pop</span> <span class="o">&lt;-</span> <span class="n">read_excel</span><span class="p">(</span><span class="s">"dataset/seoul_pop.xlsx"</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Remove ',' in columns &amp; Type casting</span>
<span class="n">seoul_pop</span><span class="err">$세대</span> <span class="o">&lt;-</span> <span class="n">gsub</span><span class="p">(</span><span class="s">'[,]'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">seoul_pop</span><span class="err">$세대</span><span class="p">)</span>
<span class="n">seoul_pop</span><span class="err">$계</span> <span class="o">&lt;-</span> <span class="n">gsub</span><span class="p">(</span><span class="s">'[,]'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">seoul_pop</span><span class="err">$계</span><span class="p">)</span>

<span class="c"># mean of 세대당 인구 by 기간별, 구별</span>
<span class="n">pop_by_quater</span> <span class="o">&lt;-</span> <span class="n">seoul_pop</span> <span class="o">%&gt;%</span> 
  <span class="n">group_by</span><span class="p">(</span><span class="err">기간</span><span class="p">,</span> <span class="err">자치구</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="n">summarise</span><span class="p">(</span><span class="err">세대당인구</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="err">세대당인구</span><span class="p">))</span>

<span class="c"># Cbind Chicken, Seoul Population</span>
<span class="n">df</span> <span class="o">&lt;-</span> <span class="n">cbind</span><span class="p">(</span><span class="n">ch_by_quater</span><span class="p">,</span> <span class="n">pop_by_quater</span><span class="p">)</span>

<span class="c"># Indexing</span>
<span class="n">df2</span> <span class="o">&lt;-</span> <span class="n">df</span><span class="p">[,</span> <span class="n">c</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">)]</span>

<span class="c"># 세대, 계 </span>
<span class="n">df2</span> <span class="o">&lt;-</span> <span class="n">cbind</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">seoul_pop</span><span class="p">[</span><span class="n">c</span><span class="p">(</span><span class="s">"세대"</span><span class="p">,</span> <span class="s">"계"</span><span class="p">)])</span>
<span class="n">df2</span><span class="p">[</span><span class="s">"세대"</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">df2</span><span class="err">$세대</span><span class="p">))</span>
<span class="n">df2</span><span class="p">[</span><span class="s">"계"</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="k">as</span><span class="o">.</span><span class="n">numeric</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">character</span><span class="p">(</span><span class="n">df2</span><span class="err">$계</span><span class="p">))</span>

<span class="c"># Plot</span>
<span class="n">p</span> <span class="o">&lt;-</span> <span class="n">df2</span> <span class="o">%&gt;%</span>
  <span class="n">plot_ly</span><span class="p">(</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">~</span><span class="err">세대당인구</span><span class="p">,</span> 
    <span class="n">y</span> <span class="o">=</span> <span class="o">~</span><span class="err">통화건수</span><span class="p">,</span> 
    <span class="n">size</span> <span class="o">=</span> <span class="o">~</span><span class="err">세대</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="o">~</span><span class="err">시군구</span><span class="p">,</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="o">~</span><span class="err">기간</span><span class="p">,</span> 
    <span class="n">text</span> <span class="o">=</span> <span class="o">~</span><span class="err">시군구</span><span class="p">,</span> 
    <span class="n">hoverinfo</span> <span class="o">=</span> <span class="s">"text"</span><span class="p">,</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s">'scatter'</span><span class="p">,</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s">'markers'</span>
  <span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="n">layout</span><span class="p">(</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
      <span class="nb">type</span> <span class="o">=</span> <span class="s">"log"</span>
    <span class="p">)</span>
  <span class="p">)</span>

<span class="n">ggplotly</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">tooltip</span> <span class="o">=</span> <span class="s">"text"</span><span class="p">)</span></code></pre></figure>

<p><br />
<br /></p>


</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/R">R</a>,&nbsp;<a href="/tag/data">data</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=%5BR%5D+%EC%B9%98%ED%82%A8+%EB%8C%80%EA%B2%A9%EB%B3%80+5%EB%85%84+-+%EC%84%9C%EC%9A%B8%EC%8B%9C+1%EC%9D%B8+%EA%B0%80%EA%B5%AC+%EB%B9%84%EC%9C%A8%EC%97%90+%EB%94%B0%EB%A5%B8+%EC%B9%98%ED%82%A8+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EB%B6%84%EC%84%9D&u=http%3A%2F%2Froseline124.github.io%2Fdata-analytics%2F2019%2F03%2F25%2FDA-R-chicken_minder.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
</section>


	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/algorithm/2019/03/24/Algorithm-baekjoon-1924.html">
					<span class="fa-stack fa-lg">
						<!-- <i class="fa fa-square fa-stack-2x"></i> -->
						<!-- <i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i> -->
            <button class="btn btn-info"><</button>
          </span>
					<span class="page-number">[백준 알고리즘#1924] 2007년 x월 y일의 요일 구하기 (python)</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/daily-study/2019/03/25/Study-190325.html">
					<span class="page-number">[오늘의 공부] 알고리즘, R - 서울시 치킨 데이터 분석</span>
					<span class="fa-stack fa-lg">
						<!-- <i class="fa fa-square fa-stack-2x"></i> -->
            <!-- <i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i> -->
            <button class="btn btn-info">></button>
					</span>
				</a>
			
		</span>
	</section>




<section class="disqus" style="margin-top:1rem;">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'roseline';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

<!-- PREVIOUS / NEXT POST -->
<!-- 
<div>
    
    <section class="post-navigation">

      <span class="prev-post">
        
          <a href="/algorithm/2019/03/24/Algorithm-baekjoon-1924.html">
            <span class="fa-stack fa-lg">
              <i class="fa fa-square fa-stack-2x"></i>
              <i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
            </span>
            <span class="page-number">[백준 알고리즘#1924] 2007년 x월 y일의 요일 구하기 (python)</span>
          </a>
        
      </span>

      <span class="next-post">
        
          <a href="/daily-study/2019/03/25/Study-190325.html">
            <span class="page-number">[오늘의 공부] 알고리즘, R - 서울시 치킨 데이터 분석</span>
            <span class="fa-stack fa-lg">
              <i class="fa fa-square fa-stack-2x"></i>
              <i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
            </span>
          </a>
        
      </span>
    </section>
  
</div> -->
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">유혹하는 개발하기</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <!-- li class="nav-link" -->
          <li><a href="/about/">About</a>
        
        
        
          <!-- li class="nav-link" -->
          <li><a href="/category/">Category</a>
        
        
        
        
        
        
        
        
        
        
        
          <!-- li class="nav-link" -->
          <li><a href="/tag/">Tag</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:guseod24@gmail.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">guseod24@gmail.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://www.facebook.com/guseod24" title="Friend me on Facebook">
              <i class="fa fa-facebook"></i>
              <span class="username">Roseline</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://github.com/roseline124" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">Roseline</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">인생은 예술을 위해 존재하는 게 아니다. 오히려 그 반대이다. - 스티븐 킹
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="/js/nav.js"></script>
<!-- <script src="//code.jquery.com/jquery-1.11.2.min.js"></script> -->
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
<script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>




<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-135996088-1', 'auto');
  ga('send', 'pageview', {
    'page': '/data-analytics/2019/03/25/DA-R-chicken_minder.html',
    'title': '[R] 치킨 대격변 5년 - 서울시 1인 가구 비율에 따른 치킨 데이터 분석'
  });
</script>



  </body>

</html>
